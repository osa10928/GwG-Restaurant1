!function o(s,a,u){function c(e,t){if(!a[e]){if(!s[e]){var n="function"==typeof require&&require;if(!t&&n)return n(e,!0);if(l)return l(e,!0);var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}var i=a[e]={exports:{}};s[e][0].call(i.exports,function(t){return c(s[e][1][t]||t)},i,i.exports,o,s,a,u)}return a[e].exports}for(var l="function"==typeof require&&require,t=0;t<u.length;t++)c(u[t]);return c}({1:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}}();var i=null;var o=function(){function o(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o)}return r(o,null,[{key:"DATABASE_URL",value:function(){return i||(i="http://localhost:1337/restaurants",setTimeout(function(){i=null},1e4),i)}},{key:"fetchRestaurants",value:function(){return fetch(o.DATABASE_URL()).then(function(t){return t.json()}).catch(function(t){return t})}},{key:"fetchRestaurantById",value:function(n,r){o.fetchRestaurants().then(function(t){var e=t.find(function(t){return t.id==n});e?r(null,e):r("Restaurant does not exist",null)}).catch(function(t){r(t,null)})}},{key:"fetchRestaurantByCuisine",value:function(n,r){o.fetchRestaurants().then(function(t){var e=t.filter(function(t){return t.cuisine_type==n});r(null,e)}).catch(function(t){r(t,null)})}},{key:"fetchRestaurantByNeighborhood",value:function(n,r){o.fetchRestaurants().then(function(t){var e=t.filter(function(t){return t.neighborhood==n});r(null,e)}).catch(function(t){r(t,null)})}},{key:"fetchRestaurantByCuisineAndNeighborhood",value:function(n,r,i){o.fetchRestaurants().then(function(t){var e=t;"all"!=n&&(e=e.filter(function(t){return t.cuisine_type==n})),"all"!=r&&(e=e.filter(function(t){return t.neighborhood==r})),i(null,e)}).catch(function(t){i(t,null)})}},{key:"fetchNeighborhoods",value:function(e){o.fetchRestaurants().then(function(n){var r=n.map(function(t,e){return n[e].neighborhood}),t=r.filter(function(t,e){return r.indexOf(t)==e});e(null,t)}).catch(function(t){e(t,null)})}},{key:"fetchCuisines",value:function(e){o.fetchRestaurants().then(function(n){var r=n.map(function(t,e){return n[e].cuisine_type}),t=r.filter(function(t,e){return r.indexOf(t)==e});e(null,t)}).catch(function(t){e(t,null)})}},{key:"urlForRestaurant",value:function(t){return"./restaurant.html?id="+t.id}},{key:"imageUrlForRestaurant",value:function(t){return"/img/"+t.photograph}},{key:"mapMarkerForRestaurant",value:function(t,e){return new google.maps.Marker({position:t.latlng,title:t.name,url:o.urlForRestaurant(t),map:e,animation:google.maps.Animation.DROP})}}]),o}();n.default=o},{}],2:[function(t,e,n){"use strict";var r=a(t("./mainController")),i=a(t("./restaurant_info")),o=a(t("./dbhelper")),s=a(t("./sw-controller"));function a(t){return t&&t.__esModule?t:{default:t}}t("intersection-observer");new s.default;if("/"==window.location.pathname){var u=new r.default;window.initMap=function(){window.map=new google.maps.Map(document.getElementById("map"),{zoom:12,center:{lat:40.722216,lng:-73.987501},scrollwheel:!1}),u.google=google,u.addMarkersToMap()},document.addEventListener("DOMContentLoaded",function(t){u.fetchNeighborhoods(),u.fetchCuisines(),u.updateRestaurants(),document.getElementById("neighborhoods-select").onchange=u.updateRestaurants,document.getElementById("cuisines-select").onchange=u.updateRestaurants})}else{var c=new i.default;window.initMap=function(){c.fetchRestaurantFromURL(function(t,e){t?console.error(t):(window.map=new google.maps.Map(document.getElementById("map"),{zoom:16,center:e.latlng,scrollwheel:!1}),c.fillBreadcrumb(),o.default.mapMarkerForRestaurant(e,window.map))})}}},{"./dbhelper":1,"./mainController":3,"./restaurant_info":4,"./sw-controller":5,"intersection-observer":7}],3:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r,i=function(){function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}}(),o=t("./dbhelper"),d=(r=o)&&r.__esModule?r:{default:r};var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.restaurants,this.neighborhoods,this.cuisines,this.map,this.markers=[],this.fetchNeighborhoods=this.fetchNeighborhoods.bind(this),this.fetchCuisines=this.fetchCuisines.bind(this),this.updateRestaurants=this.updateRestaurants.bind(this),this.resetRestaurants=this.resetRestaurants.bind(this),this.fillRestaurantsHTML=this.fillRestaurantsHTML.bind(this)}return i(t,[{key:"fetchNeighborhoods",value:function(){var n=this;d.default.fetchNeighborhoods(function(t,e){t?console.error(t):(n.neighborhoods=e,n.fillNeighborhoodsHTML())})}},{key:"fillNeighborhoodsHTML",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.neighborhoods,n=document.getElementById("neighborhoods-select");t.forEach(function(t){var e=document.createElement("option");e.innerHTML=t,e.value=t,n.append(e)})}},{key:"fetchCuisines",value:function(){var n=this;d.default.fetchCuisines(function(t,e){t?console.error(t):(n.cuisines=e,n.fillCuisinesHTML())})}},{key:"fillCuisinesHTML",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.cuisines,n=document.getElementById("cuisines-select");t.forEach(function(t){var e=document.createElement("option");e.innerHTML=t,e.value=t,n.append(e)})}},{key:"updateRestaurants",value:function(){var n=this,t=document.getElementById("cuisines-select"),e=document.getElementById("neighborhoods-select"),r=t.selectedIndex,i=e.selectedIndex,o=t[r].value,s=e[i].value;d.default.fetchRestaurantByCuisineAndNeighborhood(o,s,function(t,e){t||(n.resetRestaurants(e),n.fillRestaurantsHTML())})}},{key:"resetRestaurants",value:function(t){this.restaurants=[],document.getElementById("restaurants-list").innerHTML="",this.markers.forEach(function(t){return t.setMap(null)}),this.markers=[],this.restaurants=t}},{key:"fillRestaurantsHTML",value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.restaurants,n=document.getElementById("restaurants-list");t.forEach(function(t){n.append(e.createRestaurantHTML(t))}),this.observeImages(),this.google&&this.addMarkersToMap()}},{key:"createRestaurantHTML",value:function(t){var e=document.createElement("li"),n=d.default.imageUrlForRestaurant(t),r=n.split("/");r[1]="images",r[2]=r[2].split(".")[0],n=r.join("/");var i=document.createElement("picture"),o=document.createElement("source");o.setAttribute("media","(max-width:949px)"),o.setAttribute("srcset","//:0"),o.setAttribute("data-srcset",n+"-800medium.jpg");var s=document.createElement("source");s.setAttribute("media","(min-width:950px)"),s.setAttribute("srcset","//:0"),s.setAttribute("data-srcset",n+"-350small.jpg 1x, "+n+"-800medium.jpg 2x");var a=document.createElement("img");a.className+="img-responsive",a.className+=" observed-img",a.src="//:0",a.setAttribute("data-src",d.default.imageUrlForRestaurant(t)),a.setAttribute("alt","image of restaurant "+t.name),i.append(o),i.append(s),i.append(a),e.append(i);var u=document.createElement("h2");u.innerHTML=t.name,e.append(u);var c=document.createElement("p");c.innerHTML=t.neighborhood,e.append(c);var l=document.createElement("p");l.innerHTML=t.address,e.append(l);var h=document.createElement("a");return h.innerHTML="View Details",h.href=d.default.urlForRestaurant(t),h.setAttribute("aria-label","view details for restaurant "+t.name),e.append(h),e}},{key:"observeImages",value:function(){var t=document.querySelectorAll(".observed-img"),i=new IntersectionObserver(function(t){t.forEach(function(t){if(0<t.intersectionRatio){var e=t.target,n=(t.target.parentElement,t.target.parentElement.childNodes[0]),r=t.target.parentElement.childNodes[1];e.setAttribute("src",e.getAttribute("data-src")),n.setAttribute("srcset",n.getAttribute("data-srcset")),r.setAttribute("srcset",r.getAttribute("date-srcset")),i.unobserve(t.target)}})});t.forEach(function(t){i.observe(t)})}},{key:"addMarkersToMap",value:function(){var n=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.restaurants;console.log(t),t.forEach(function(t){var e=d.default.mapMarkerForRestaurant(t,window.map);n.google.maps.event.addListener(e,"click",function(){window.location.href=e.url}),n.markers.push(e)})}}]),t}();n.default=s},{"./dbhelper":1}],4:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r,i=function(){function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}}(),o=t("./dbhelper"),u=(r=o)&&r.__esModule?r:{default:r};var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.restaurant,this.map,this.fetchRestaurantFromURL=this.fetchRestaurantFromURL.bind(this),this.fillRestaurantHTML=this.fillRestaurantHTML.bind(this),this.fillReviewsHTML=this.fillReviewsHTML.bind(this)}return i(t,[{key:"fetchRestaurantFromURL",value:function(n){var r=this;if(this.restaurant)n(null,this.restaurant);else{var t=this.getParameterByName("id");t?u.default.fetchRestaurantById(t,function(t,e){(r.restaurant=e)?(r.fillRestaurantHTML(),n(null,r.restaurant)):console.error(t)}):(error="No restaurant id in URL",n(error,null))}}},{key:"fillRestaurantHTML",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.restaurant;document.getElementById("restaurant-name").innerHTML=t.name,document.getElementById("restaurant-address").innerHTML=t.address;var e=u.default.imageUrlForRestaurant(t),n=e.split("/");n[1]="images",n[2]=n[2].split(".")[0],e=n.join("/");var r=document.getElementById("restaurant-img"),i=document.createElement("source");i.setAttribute("media","(max-width:949px)"),i.setAttribute("srcset",e+"-800medium.jpg");var o=document.createElement("source");o.setAttribute("media","(min-width:950px)"),o.setAttribute("srcset",e+"-350small.jpg 1x, "+e+"-800medium.jpg 2x");var s=document.createElement("img");s.className="restaurant-img",s.src=u.default.imageUrlForRestaurant(t),s.setAttribute("alt","image of restaurant "+t.name),r.append(i),r.append(o),r.append(s);var a=document.getElementById("restaurant-cuisine");a.innerHTML=t.cuisine_type,a.setAttribute("aria-label","cuisine type: "+t.cuisine_type),t.operating_hours&&this.fillRestaurantHoursHTML(),this.fillReviewsHTML()}},{key:"fillRestaurantHoursHTML",value:function(){for(var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.restaurant.operating_hours,e=document.getElementById("restaurant-hours"),n=["M","Tue","W","Th","F","Sat","Sun"],r=Object.keys(t),i=0;i<r.length;i++){var o=document.createElement("tr"),s=document.createElement("td");s.innerHTML=r[i],s.setAttribute("data-td","full"),o.appendChild(s);var a=document.createElement("td");a.innerHTML=n[i],a.setAttribute("data-td","abbr"),o.appendChild(a);var u=document.createElement("td");u.innerHTML=t[r[i]],u.setAttribute("data-td","timesOpen"),o.appendChild(u),e.appendChild(o)}}},{key:"fillReviewsHTML",value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.restaurant.reviews,n=document.getElementById("reviews-container"),r=document.createElement("h3");if(r.innerHTML="Reviews",n.appendChild(r),!t){var i=document.createElement("p");return i.innerHTML="No reviews yet!",void n.appendChild(i)}var o=document.getElementById("reviews-list");t.forEach(function(t){o.appendChild(e.createReviewHTML(t))}),n.appendChild(o)}},{key:"createReviewHTML",value:function(t){var e=document.createElement("li"),n=document.createElement("p");n.innerHTML=t.name,e.appendChild(n);var r=document.createElement("p");r.innerHTML=t.date,e.appendChild(r);var i=document.createElement("p");i.innerHTML="Rating: "+t.rating,e.appendChild(i);var o=document.createElement("p");return o.innerHTML=t.comments,e.appendChild(o),e}},{key:"fillBreadcrumb",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.restaurant,e=document.getElementById("breadcrumb"),n=document.createElement("li");n.innerHTML=t.name,e.appendChild(n)}},{key:"getParameterByName",value:function(t,e){e||(e=window.location.href),t=t.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)").exec(e);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}}]),t}();n.default=s},{"./dbhelper":1}],5:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r,i=function(){function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}}(),o=t("idb"),s=(r=o)&&r.__esModule?r:{default:r};var a=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.dbPromise=navigator.serviceWorker?s.default.open("restaurantReview",1,function(t){t.createObjectStore("restaurants")}):Promise.resolve(),this.registerServiceWorker=this.registerServiceWorker.bind(this),this.getCachedRestaurants=this.getCachedRestaurants.bind(this),this.registerServiceWorker(),this.getCachedRestaurants()}return i(t,[{key:"registerServiceWorker",value:function(){navigator.serviceWorker&&navigator.serviceWorker.register("/sw.js").then(function(t){console.log("serviceWorker registered!")}).catch(function(t){console.log(t)})}},{key:"getCachedRestaurants",value:function(){return this.dbPromise.then(function(t){if(t)return t.transaction("restaurants").objectStore("restaurants").getAll()})}}]),t}();n.default=a},{idb:6}],6:[function(t,f,e){"use strict";!function(){function s(n){return new Promise(function(t,e){n.onsuccess=function(){t(n.result)},n.onerror=function(){e(n.error)}})}function o(n,r,i){var o,t=new Promise(function(t,e){s(o=n[r].apply(n,i)).then(t,e)});return t.request=o,t}function t(t,n,e){e.forEach(function(e){Object.defineProperty(t.prototype,e,{get:function(){return this[n][e]},set:function(t){this[n][e]=t}})})}function e(e,n,r,t){t.forEach(function(t){t in r.prototype&&(e.prototype[t]=function(){return o(this[n],t,arguments)})})}function n(e,n,r,t){t.forEach(function(t){t in r.prototype&&(e.prototype[t]=function(){return this[n][t].apply(this[n],arguments)})})}function r(t,r,e,n){n.forEach(function(n){n in e.prototype&&(t.prototype[n]=function(){return t=this[r],(e=o(t,n,arguments)).then(function(t){if(t)return new a(t,e.request)});var t,e})})}function i(t){this._index=t}function a(t,e){this._cursor=t,this._request=e}function u(t){this._store=t}function c(n){this._tx=n,this.complete=new Promise(function(t,e){n.oncomplete=function(){t()},n.onerror=function(){e(n.error)},n.onabort=function(){e(n.error)}})}function l(t,e,n){this._db=t,this.oldVersion=e,this.transaction=new c(n)}function h(t){this._db=t}t(i,"_index",["name","keyPath","multiEntry","unique"]),e(i,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),r(i,"_index",IDBIndex,["openCursor","openKeyCursor"]),t(a,"_cursor",["direction","key","primaryKey","value"]),e(a,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach(function(n){n in IDBCursor.prototype&&(a.prototype[n]=function(){var e=this,t=arguments;return Promise.resolve().then(function(){return e._cursor[n].apply(e._cursor,t),s(e._request).then(function(t){if(t)return new a(t,e._request)})})})}),u.prototype.createIndex=function(){return new i(this._store.createIndex.apply(this._store,arguments))},u.prototype.index=function(){return new i(this._store.index.apply(this._store,arguments))},t(u,"_store",["name","keyPath","indexNames","autoIncrement"]),e(u,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),r(u,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),n(u,"_store",IDBObjectStore,["deleteIndex"]),c.prototype.objectStore=function(){return new u(this._tx.objectStore.apply(this._tx,arguments))},t(c,"_tx",["objectStoreNames","mode"]),n(c,"_tx",IDBTransaction,["abort"]),l.prototype.createObjectStore=function(){return new u(this._db.createObjectStore.apply(this._db,arguments))},t(l,"_db",["name","version","objectStoreNames"]),n(l,"_db",IDBDatabase,["deleteObjectStore","close"]),h.prototype.transaction=function(){return new c(this._db.transaction.apply(this._db,arguments))},t(h,"_db",["name","version","objectStoreNames"]),n(h,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach(function(o){[u,i].forEach(function(t){t.prototype[o.replace("open","iterate")]=function(){var t,e=(t=arguments,Array.prototype.slice.call(t)),n=e[e.length-1],r=this._store||this._index,i=r[o].apply(r,e.slice(0,-1));i.onsuccess=function(){n(i.result)}}})}),[i,u].forEach(function(t){t.prototype.getAll||(t.prototype.getAll=function(t,n){var r=this,i=[];return new Promise(function(e){r.iterateCursor(t,function(t){t?(i.push(t.value),void 0===n||i.length!=n?t.continue():e(i)):e(i)})})})});var d={open:function(t,e,n){var r=o(indexedDB,"open",[t,e]),i=r.request;return i.onupgradeneeded=function(t){n&&n(new l(i.result,t.oldVersion,i.transaction))},r.then(function(t){return new h(t)})},delete:function(t){return o(indexedDB,"deleteDatabase",[t])}};void 0!==f?(f.exports=d,f.exports.default=f.exports):self.idb=d}()},{}],7:[function(t,e,n){!function(m,v){"use strict";if("IntersectionObserver"in m&&"IntersectionObserverEntry"in m&&"intersectionRatio"in m.IntersectionObserverEntry.prototype)"isIntersecting"in m.IntersectionObserverEntry.prototype||Object.defineProperty(m.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return 0<this.intersectionRatio}});else{var e=[];t.prototype.THROTTLE_TIMEOUT=100,t.prototype.POLL_INTERVAL=null,t.prototype.USE_MUTATION_OBSERVER=!0,t.prototype.observe=function(e){if(!this._observationTargets.some(function(t){return t.element==e})){if(!e||1!=e.nodeType)throw new Error("target must be an Element");this._registerInstance(),this._observationTargets.push({element:e,entry:null}),this._monitorIntersections(),this._checkForIntersections()}},t.prototype.unobserve=function(e){this._observationTargets=this._observationTargets.filter(function(t){return t.element!=e}),this._observationTargets.length||(this._unmonitorIntersections(),this._unregisterInstance())},t.prototype.disconnect=function(){this._observationTargets=[],this._unmonitorIntersections(),this._unregisterInstance()},t.prototype.takeRecords=function(){var t=this._queuedEntries.slice();return this._queuedEntries=[],t},t.prototype._initThresholds=function(t){var e=t||[0];return Array.isArray(e)||(e=[e]),e.sort().filter(function(t,e,n){if("number"!=typeof t||isNaN(t)||t<0||1<t)throw new Error("threshold must be a number between 0 and 1 inclusively");return t!==n[e-1]})},t.prototype._parseRootMargin=function(t){var e=(t||"0px").split(/\s+/).map(function(t){var e=/^(-?\d*\.?\d+)(px|%)$/.exec(t);if(!e)throw new Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(e[1]),unit:e[2]}});return e[1]=e[1]||e[0],e[2]=e[2]||e[0],e[3]=e[3]||e[1],e},t.prototype._monitorIntersections=function(){this._monitoringIntersections||(this._monitoringIntersections=!0,this.POLL_INTERVAL?this._monitoringInterval=setInterval(this._checkForIntersections,this.POLL_INTERVAL):(n(m,"resize",this._checkForIntersections,!0),n(v,"scroll",this._checkForIntersections,!0),this.USE_MUTATION_OBSERVER&&"MutationObserver"in m&&(this._domObserver=new MutationObserver(this._checkForIntersections),this._domObserver.observe(v,{attributes:!0,childList:!0,characterData:!0,subtree:!0}))))},t.prototype._unmonitorIntersections=function(){this._monitoringIntersections&&(this._monitoringIntersections=!1,clearInterval(this._monitoringInterval),this._monitoringInterval=null,r(m,"resize",this._checkForIntersections,!0),r(v,"scroll",this._checkForIntersections,!0),this._domObserver&&(this._domObserver.disconnect(),this._domObserver=null))},t.prototype._checkForIntersections=function(){var a=this._rootIsInDom(),u=a?this._getRootRect():{top:0,bottom:0,left:0,right:0,width:0,height:0};this._observationTargets.forEach(function(t){var e=t.element,n=g(e),r=this._rootContainsTarget(e),i=t.entry,o=a&&r&&this._computeTargetAndRootIntersection(e,u),s=t.entry=new c({time:m.performance&&performance.now&&performance.now(),target:e,boundingClientRect:n,rootBounds:u,intersectionRect:o});i?a&&r?this._hasCrossedThreshold(i,s)&&this._queuedEntries.push(s):i&&i.isIntersecting&&this._queuedEntries.push(s):this._queuedEntries.push(s)},this),this._queuedEntries.length&&this._callback(this.takeRecords(),this)},t.prototype._computeTargetAndRootIntersection=function(t,e){if("none"!=m.getComputedStyle(t).display){for(var n,r,i,o,s,a,u,c,l=g(t),h=b(t),d=!1;!d;){var f=null,p=1==h.nodeType?m.getComputedStyle(h):{};if("none"==p.display)return;if(h==this.root||h==v?(d=!0,f=e):h!=v.body&&h!=v.documentElement&&"visible"!=p.overflow&&(f=g(h)),f&&(n=f,r=l,void 0,i=Math.max(n.top,r.top),o=Math.min(n.bottom,r.bottom),s=Math.max(n.left,r.left),a=Math.min(n.right,r.right),c=o-i,!(l=0<=(u=a-s)&&0<=c&&{top:i,bottom:o,left:s,right:a,width:u,height:c})))break;h=b(h)}return l}},t.prototype._getRootRect=function(){var t;if(this.root)t=g(this.root);else{var e=v.documentElement,n=v.body;t={top:0,left:0,right:e.clientWidth||n.clientWidth,width:e.clientWidth||n.clientWidth,bottom:e.clientHeight||n.clientHeight,height:e.clientHeight||n.clientHeight}}return this._expandRectByRootMargin(t)},t.prototype._expandRectByRootMargin=function(n){var t=this._rootMarginValues.map(function(t,e){return"px"==t.unit?t.value:t.value*(e%2?n.width:n.height)/100}),e={top:n.top-t[0],right:n.right+t[1],bottom:n.bottom+t[2],left:n.left-t[3]};return e.width=e.right-e.left,e.height=e.bottom-e.top,e},t.prototype._hasCrossedThreshold=function(t,e){var n=t&&t.isIntersecting?t.intersectionRatio||0:-1,r=e.isIntersecting?e.intersectionRatio||0:-1;if(n!==r)for(var i=0;i<this.thresholds.length;i++){var o=this.thresholds[i];if(o==n||o==r||o<n!=o<r)return!0}},t.prototype._rootIsInDom=function(){return!this.root||i(v,this.root)},t.prototype._rootContainsTarget=function(t){return i(this.root||v,t)},t.prototype._registerInstance=function(){e.indexOf(this)<0&&e.push(this)},t.prototype._unregisterInstance=function(){var t=e.indexOf(this);-1!=t&&e.splice(t,1)},m.IntersectionObserver=t,m.IntersectionObserverEntry=c}function c(t){this.time=t.time,this.target=t.target,this.rootBounds=t.rootBounds,this.boundingClientRect=t.boundingClientRect,this.intersectionRect=t.intersectionRect||{top:0,bottom:0,left:0,right:0,width:0,height:0},this.isIntersecting=!!t.intersectionRect;var e=this.boundingClientRect,n=e.width*e.height,r=this.intersectionRect,i=r.width*r.height;this.intersectionRatio=n?i/n:this.isIntersecting?1:0}function t(t,e){var n,r,i,o=e||{};if("function"!=typeof t)throw new Error("callback must be a function");if(o.root&&1!=o.root.nodeType)throw new Error("root must be an Element");this._checkForIntersections=(n=this._checkForIntersections.bind(this),r=this.THROTTLE_TIMEOUT,i=null,function(){i||(i=setTimeout(function(){n(),i=null},r))}),this._callback=t,this._observationTargets=[],this._queuedEntries=[],this._rootMarginValues=this._parseRootMargin(o.rootMargin),this.thresholds=this._initThresholds(o.threshold),this.root=o.root||null,this.rootMargin=this._rootMarginValues.map(function(t){return t.value+t.unit}).join(" ")}function n(t,e,n,r){"function"==typeof t.addEventListener?t.addEventListener(e,n,r||!1):"function"==typeof t.attachEvent&&t.attachEvent("on"+e,n)}function r(t,e,n,r){"function"==typeof t.removeEventListener?t.removeEventListener(e,n,r||!1):"function"==typeof t.detatchEvent&&t.detatchEvent("on"+e,n)}function g(t){var e;try{e=t.getBoundingClientRect()}catch(t){}return e?(e.width&&e.height||(e={top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.right-e.left,height:e.bottom-e.top}),e):{top:0,bottom:0,left:0,right:0,width:0,height:0}}function i(t,e){for(var n=e;n;){if(n==t)return!0;n=b(n)}return!1}function b(t){var e=t.parentNode;return e&&11==e.nodeType&&e.host?e.host:e}}(window,document)},{}]},{},[2]);